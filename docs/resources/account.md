---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "smallstep_account Resource - terraform-provider-smallstep"
subcategory: ""
description: |-
  An account configures the certificate a device uses to connect to a protected resource.
---

# smallstep_account (Resource)

An account configures the certificate a device uses to connect to a protected resource.

## Example Usage

```terraform
resource "smallstep_account" "wifi" {
  name = "WiFi Hosted Radius"
  wifi = {
    autojoin                 = true
    external_radius_server   = false
    hidden                   = true
    network_access_server_ip = "0.0.0.1"
    ssid                     = "corpnet"
  }
}

resource "smallstep_account" "ethernet" {
  name = "Ethernet External RADIUS"
  ethernet = {
    autojoin               = false
    external_radius_server = true
    ca_chain               = file("radius-ca.pem")
  }
}

resource "smallstep_account" "vpn" {
  name = "VPN"
  vpn = {
    autojoin        = false
    connection_type = "IKEv2"
    remote_address  = "ike.example.com"
    ike = {
      ca_chain  = file("ike-ca.pem")
      eap       = true
      remote_id = "foo"
    }
  }
}

resource "smallstep_account" "browser" {
  name    = "Browser Certificate"
  browser = {}
}

resource "smallstep_account" "generic" {
  name = "Generic Client Certificate"
  certificate = {
    duration  = "168h"
    crt_file  = "db.crt"
    key_file  = "db.key"
    root_file = "ca.crt"
    uid       = 1001
    gid       = 999
    mode      = 256
    x509 = {
      common_name = {
        static          = "example.com"
        device_metadata = "host"
      }
      sans = {
        static          = ["user@example.com"]
        device_metadata = ["sans"]
      }
      organization = {
        static = ["ops"]
      }
      organizational_unit = {
        static = ["dev"]
      }
      locality = {
        static = ["DC"]
      }
      postal_code = {
        static = ["20252"]
      }
      country = {
        device_metadata = ["country"]
      }
      street_address = {
        device_metadata = ["street"]
      }
      province = {
        device_metadata = ["province"]
      }
    }
  }
  reload = {
    method   = "SIGNAL"
    pid_file = "x.pid"
    signal   = 1
  }
  key = {
    format     = "DER"
    type       = "ECDSA_P256"
    protection = "NONE"
  }
  policy = {
    assurance = ["high"]
    os        = ["Windows", "macOS"]
    ownership = ["company"]
    source    = ["Jamf", "Intune"]
    tags      = ["mdm"]
  }
}

resource "smallstep_account" "ssh" {
  name = "SSH User Certificate"
  certificate = {
    ssh = {
      key_id = {
        device_metadata = "key"
      }
      principals = {
        static          = ["eng"]
        device_metadata = ["role"]
      }
    }
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `name` (String) A human-friendly name for this account.

### Optional

- `browser` (Attributes) Configuration to use a client certificate. (see [below for nested schema](#nestedatt--browser))
- `certificate` (Attributes) Details on a managed certificate. (see [below for nested schema](#nestedatt--certificate))
- `ethernet` (Attributes) Configuration to connect a device to a protected LAN. (see [below for nested schema](#nestedatt--ethernet))
- `key` (Attributes) The attributes of the cryptographic key. (see [below for nested schema](#nestedatt--key))
- `policy` (Attributes) Policy to select the devices an account is assigned to. An empty policy indicates an account will be provisioned for all devices. (see [below for nested schema](#nestedatt--policy))
- `reload` (Attributes) The properties used to reload a service. (see [below for nested schema](#nestedatt--reload))
- `vpn` (Attributes) Configuration to connect a device to a VPN. (see [below for nested schema](#nestedatt--vpn))
- `wifi` (Attributes) Configuration to connect a device to a protected WiFi network. (see [below for nested schema](#nestedatt--wifi))

### Read-Only

- `id` (String) A UUID identifying this account. Read only.

<a id="nestedatt--browser"></a>
### Nested Schema for `browser`


<a id="nestedatt--certificate"></a>
### Nested Schema for `certificate`

Optional:

- `authority_id` (String) A UUID identifying the authority to issue certificates for the account. If not provided, a new authority will be created.
- `crt_file` (String) The filepath where the certificate is to be stored.
- `duration` (String) The certificate lifetime. Parsed as a [Golang duration](https://pkg.go.dev/time#ParseDuration).
- `gid` (Number) GID of the files where the certificate is stored.
- `key_file` (String) The filepath where the key is to be stored.
- `mode` (Number) Permission bits of the files where the certificate is stored.
- `root_file` (String) The filepath where the root certificate is to be stored.
- `ssh` (Attributes) Populate certificate fields using static names or device metadata. (see [below for nested schema](#nestedatt--certificate--ssh))
- `uid` (Number) UID of the files where the certificate is stored.
- `x509` (Attributes) Populate certificate fields using using static names or device metadata. (see [below for nested schema](#nestedatt--certificate--x509))

<a id="nestedatt--certificate--ssh"></a>
### Nested Schema for `certificate.ssh`

Required:

- `key_id` (Attributes) (see [below for nested schema](#nestedatt--certificate--ssh--key_id))

Optional:

- `principals` (Attributes) (see [below for nested schema](#nestedatt--certificate--ssh--principals))

<a id="nestedatt--certificate--ssh--key_id"></a>
### Nested Schema for `certificate.ssh.key_id`

Optional:

- `device_metadata` (String)
- `static` (String)


<a id="nestedatt--certificate--ssh--principals"></a>
### Nested Schema for `certificate.ssh.principals`

Optional:

- `device_metadata` (List of String)
- `static` (List of String)



<a id="nestedatt--certificate--x509"></a>
### Nested Schema for `certificate.x509`

Required:

- `common_name` (Attributes) (see [below for nested schema](#nestedatt--certificate--x509--common_name))

Optional:

- `country` (Attributes) (see [below for nested schema](#nestedatt--certificate--x509--country))
- `locality` (Attributes) (see [below for nested schema](#nestedatt--certificate--x509--locality))
- `organization` (Attributes) (see [below for nested schema](#nestedatt--certificate--x509--organization))
- `organizational_unit` (Attributes) (see [below for nested schema](#nestedatt--certificate--x509--organizational_unit))
- `postal_code` (Attributes) (see [below for nested schema](#nestedatt--certificate--x509--postal_code))
- `province` (Attributes) (see [below for nested schema](#nestedatt--certificate--x509--province))
- `sans` (Attributes) (see [below for nested schema](#nestedatt--certificate--x509--sans))
- `street_address` (Attributes) (see [below for nested schema](#nestedatt--certificate--x509--street_address))

<a id="nestedatt--certificate--x509--common_name"></a>
### Nested Schema for `certificate.x509.common_name`

Optional:

- `device_metadata` (String)
- `static` (String)


<a id="nestedatt--certificate--x509--country"></a>
### Nested Schema for `certificate.x509.country`

Optional:

- `device_metadata` (List of String)
- `static` (List of String)


<a id="nestedatt--certificate--x509--locality"></a>
### Nested Schema for `certificate.x509.locality`

Optional:

- `device_metadata` (List of String)
- `static` (List of String)


<a id="nestedatt--certificate--x509--organization"></a>
### Nested Schema for `certificate.x509.organization`

Optional:

- `device_metadata` (List of String)
- `static` (List of String)


<a id="nestedatt--certificate--x509--organizational_unit"></a>
### Nested Schema for `certificate.x509.organizational_unit`

Optional:

- `device_metadata` (List of String)
- `static` (List of String)


<a id="nestedatt--certificate--x509--postal_code"></a>
### Nested Schema for `certificate.x509.postal_code`

Optional:

- `device_metadata` (List of String)
- `static` (List of String)


<a id="nestedatt--certificate--x509--province"></a>
### Nested Schema for `certificate.x509.province`

Optional:

- `device_metadata` (List of String)
- `static` (List of String)


<a id="nestedatt--certificate--x509--sans"></a>
### Nested Schema for `certificate.x509.sans`

Optional:

- `device_metadata` (List of String)
- `static` (List of String)


<a id="nestedatt--certificate--x509--street_address"></a>
### Nested Schema for `certificate.x509.street_address`

Optional:

- `device_metadata` (List of String)
- `static` (List of String)




<a id="nestedatt--ethernet"></a>
### Nested Schema for `ethernet`

Optional:

- `autojoin` (Boolean) Whether or not clients should automatically connect to the network.
- `ca_chain` (String) The certificate authority bundle that client certificates must chain up to.
- `external_radius_server` (Boolean) Whether or not this network is configured to use Smallstep or external RADIUS.
- `network_access_server_ip` (String) The public IP address of your network equipment that clients connect to.


<a id="nestedatt--key"></a>
### Nested Schema for `key`

Required:

- `format` (String) The format used to encode the private key. For X509 keys the default format is PKCS#8. The classic format is PKCS#1 for RSA keys, SEC 1 for ECDSA keys, and PKCS#8 for ED25519 keys. For SSH keys the default format is always the OPENSSH format. When a hardware module is used to store the keys the default will be a JSON representation of the key, except on Linux where tss2 will be used. Allowed values: `DEFAULT` `PKCS8` `OPENSSH` `TSS2` `CLASSIC`
- `type` (String) The key type used. The current DEFAULT type is ECDSA_P256. Allowed values: `DEFAULT` `ECDSA_P256` `ECDSA_P384` `ECDSA_P521` `RSA_2048` `RSA_3072` `RSA_4096` `ED25519`

Optional:

- `protection` (String) Whether to use a hardware module to store the private key for a workload certificate. If set to `NONE` no hardware module will be used. If set to `DEFAULT` a hardware module will only be used with format `TSS2`. `HARDWARE_WITH_FALLBACK` can only be used with the key format `DEFAULT`. Allowed values: `DEFAULT` `NONE` `HARDWARE` `HARDWARE_WITH_FALLBACK` `HARDWARE_ATTESTED`
- `pub_file` (String) A CSR or SSH public key to use instead of generating one.


<a id="nestedatt--policy"></a>
### Nested Schema for `policy`

Optional:

- `assurance` (List of String) Assurance levels that devices must match. Allowed values: `normal` `high`
- `os` (List of String) Operating systems that devices must match. Allowed values: `Linux` `Windows` `macOS` `iOS` `tvOS` `watchOS` `visionOS`
- `ownership` (List of String) Ownership values that devices must match. Allowed values: `company` `user`
- `source` (List of String) Registration sources that devices must match. Allowed values: `End-User` `Smallstep API` `Smallstep Agent` `Jamf` `Intune`
- `tags` (List of String) Tags that devices must match.


<a id="nestedatt--reload"></a>
### Nested Schema for `reload`

Required:

- `method` (String) Ways an endpoint can reload a certificate. `AUTOMATIC` means the process is able to detect and reload new certificates automatically. `CUSTOM` means a custom command must be run to trigger the workload to reload the certificates. `SIGNAL` will configure the agent to send a signal to the process in `pidFile`. `DBUS` will use the systemd system bus to issue a `try-reload-or-restart` job for unit specified by `unitName`. `PLATFORM` uses a method specific to the operating system. Allowed values: `AUTOMATIC` `CUSTOM` `SIGNAL` `DBUS` `PLATFORM`

Optional:

- `pid_file` (String) File that holds the pid of the process to signal. Required when method is SIGNAL.
- `signal` (Number) The signal to send to a process when a certificate should be reloaded. Required when method is SIGNAL.
- `unit_name` (String) The systemd unit name to reload when a certificate should be reloaded. Required when method is DBUS.


<a id="nestedatt--vpn"></a>
### Nested Schema for `vpn`

Required:

- `connection_type` (String) The type of VPN connection. Allowed values: `IPSec` `IKEv2` `SSL`
- `remote_address` (String) The public IP address of the VPN server.

Optional:

- `autojoin` (Boolean) Whether or not clients should automatically connect to the network.
- `ike` (Attributes) (see [below for nested schema](#nestedatt--vpn--ike))
- `vendor` (String) For SSL-type VPN connections, the vendor of the VPN. Allowed values: `F5` `Cisco` `Juniper`

<a id="nestedatt--vpn--ike"></a>
### Nested Schema for `vpn.ike`

Optional:

- `ca_chain` (String) The certificate authority bundle that client certificates must chain up to.
- `eap` (Boolean) Whether or not EAP is enforced on this VPN server.
- `remote_id` (String) Typically, the common name of the remote server. Defaults to the remote address.



<a id="nestedatt--wifi"></a>
### Nested Schema for `wifi`

Required:

- `ssid` (String) The name of the wireless network clients connect to.

Optional:

- `autojoin` (Boolean) Whether or not clients should automatically connect to the network.
- `ca_chain` (String) The certificate authority bundle that client certificates must chain up to.
- `external_radius_server` (Boolean) Whether or not this network is configured to use Smallstep or external RADIUS.
- `hidden` (Boolean) Whether or not the SSID is broadcast by the access points.
- `network_access_server_ip` (String) The public IP address of your network equipment that clients connect to.

## Import

Import is supported using the following syntax:

The [`terraform import` command](https://developer.hashicorp.com/terraform/cli/commands/import) can be used, for example:

```shell
terraform import smallstep_account.wifi b1161f78-d251-401e-b17c-fe38fc26ae7b
```
