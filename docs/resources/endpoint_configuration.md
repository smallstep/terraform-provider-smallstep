---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "smallstep_endpoint_configuration Resource - terraform-provider-smallstep"
subcategory: ""
description: |-
  Configuration for a managed endpoint
---

# smallstep_endpoint_configuration (Resource)

Configuration for a managed endpoint

## Example Usage

```terraform
resource "smallstep_endpoint_configuration" "x509" {
  name = "My DB"
  kind = "WORKLOAD"

  authority_id     = smallstep_authority.endpoints.id
  provisioner_name = smallstep_provisioner.endpoints_x5c.name

  certificate_info = {
    type      = "X509"
    duration  = "168h"
    crt_file  = "db.crt"
    key_file  = "db.key"
    root_file = "ca.crt"
    uid       = 1001
    gid       = 999
    mode      = 256
  }

  hooks = {
    renew = {
      shell    = "/bin/sh"
      before   = ["echo renewing"]
      after    = ["echo renewed"]
      on_error = ["echo failed renew"]
    }
    sign = {
      shell    = "/bin/bash"
      before   = ["echo signing"]
      after    = ["echo signed"]
      on_error = ["echo failed sign"]
    }
  }

  key_info = {
    format   = "DEFAULT"
    type     = "ECDSA_P256"
    pub_file = "file.csr"
  }

  reload_info = {
    method   = "SIGNAL"
    pid_file = "db.pid"
    signal   = 1
  }
}

resource "smallstep_endpoint_configuration" "ssh" {
  name             = "SSH"
  kind             = "PEOPLE"
  authority_id     = smallstep_authority.endpoints.id
  provisioner_name = smallstep_provisioner.endpoints_x5c.name
  certificate_info = {
    type = "SSH_USER"
  }
  key_info = {
    type   = "RSA_2048"
    format = "OPENSSH"
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `authority_id` (String) UUID identifying the authority that will issue certificates for the endpoint.
- `certificate_info` (Attributes) Details on a managed certificate (see [below for nested schema](#nestedatt--certificate_info))
- `key_info` (Attributes) The attributes of the cryptographic key. (see [below for nested schema](#nestedatt--key_info))
- `kind` (String) The kind of endpoint this configuration applies to. Allowed values: `DEVICE` `WORKLOAD` `PEOPLE`
- `name` (String) The name of the endpoint configuration.
- `provisioner_name` (String) Name of the provisioner on the authority that will authorize certificates for the endpoint.

### Optional

- `hooks` (Attributes) The collection of commands to run when a certificate for a managed endpoint is signed or renewed. (see [below for nested schema](#nestedatt--hooks))
- `reload_info` (Attributes) The properties used to reload a service. (see [below for nested schema](#nestedatt--reload_info))

### Read-Only

- `id` (String) A UUID identifying this endpoint configuration. Generated server-side when the endpoint configuration is created.

<a id="nestedatt--certificate_info"></a>
### Nested Schema for `certificate_info`

Required:

- `type` (String) The type of certificate Allowed values: `X509` `SSH_USER` `SSH_HOST`

Optional:

- `crt_file` (String) The filepath where the certificate is to be stored.
- `duration` (String) The certificate lifetime. Parsed as a [Golang duration](https://pkg.go.dev/time#ParseDuration).
- `gid` (Number) GID of the files where the certificate is stored.
- `key_file` (String) The filepath where the key is to be stored.
- `mode` (Number) Permission bits of the files where the certificate is stored.
- `root_file` (String) The filepath where the root certificate is to be stored.
- `uid` (Number) UID of the files where the certificate is stored.


<a id="nestedatt--key_info"></a>
### Nested Schema for `key_info`

Required:

- `format` (String) The format used to encode the private key. For X509 keys the default format is SEC 1 for ECDSA keys, PKCS#1 for RSA keys and PKCS#8 for ED25519 keys. For SSH keys the default format is always the OPENSSH format. Allowed values: `DEFAULT` `PKCS8` `OPENSSH` `DER`
- `type` (String) The key type used. The current DEFAULT type is ECDSA_P256. Allowed values: `DEFAULT` `ECDSA_P256` `ECDSA_P384` `ECDSA_P521` `RSA_2048` `RSA_3072` `RSA_4096` `ED25519`

Optional:

- `pub_file` (String) A CSR or SSH public key to use instead of generating one.


<a id="nestedatt--hooks"></a>
### Nested Schema for `hooks`

Optional:

- `renew` (Attributes) A list of commands to run before and after a certificate is granted. (see [below for nested schema](#nestedatt--hooks--renew))
- `sign` (Attributes) A list of commands to run before and after a certificate is granted. (see [below for nested schema](#nestedatt--hooks--sign))

<a id="nestedatt--hooks--renew"></a>
### Nested Schema for `hooks.renew`

Optional:

- `after` (List of String) List of commands to run after the operation.
- `before` (List of String) List of commands to run before the operation.
- `on_error` (List of String) List of commands to run when the operation fails.
- `shell` (String) The shell to use to execute the commands.


<a id="nestedatt--hooks--sign"></a>
### Nested Schema for `hooks.sign`

Optional:

- `after` (List of String) List of commands to run after the operation.
- `before` (List of String) List of commands to run before the operation.
- `on_error` (List of String) List of commands to run when the operation fails.
- `shell` (String) The shell to use to execute the commands.



<a id="nestedatt--reload_info"></a>
### Nested Schema for `reload_info`

Required:

- `method` (String) Ways an endpoint can reload a certificate. `AUTOMATIC` means the process is able to detect and reload new certificates automatically. `CUSTOM` means a custom command must be run to trigger the workload to reload the certificates. `SIGNAL` will configure the agent to send a signal to the process in pidFile. Allowed values: `AUTOMATIC` `CUSTOM` `SIGNAL`

Optional:

- `pid_file` (String) File that holds the pid of the process to signal. Required when method is SIGNAL.
- `signal` (Number) The signal to send to a process when a certificate should be reloaded. Required when method is SIGNAL.

## Import

Import is supported using the following syntax:

```shell
terraform import smallstep_endpoint_configuration.ep1 7bcde9eb-daf8-4be7-9d82-21da3ff60e81
```
